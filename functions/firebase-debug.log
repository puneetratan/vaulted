[debug] [2025-11-14T02:49:00.871Z] ----------------------------------------------------------------------
[debug] [2025-11-14T02:49:00.873Z] Command:       /Users/puneet/.nvm/versions/node/v24.11.0/bin/node /Users/puneet/.nvm/versions/node/v24.11.0/bin/firebase emulators:start --only functions
[debug] [2025-11-14T02:49:00.874Z] CLI Version:   14.24.1
[debug] [2025-11-14T02:49:00.874Z] Platform:      darwin
[debug] [2025-11-14T02:49:00.874Z] Node Version:  v24.11.0
[debug] [2025-11-14T02:49:00.874Z] Time:          Thu Nov 13 2025 21:49:00 GMT-0500 (Eastern Standard Time)
[debug] [2025-11-14T02:49:00.874Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-14T02:49:01.058Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-14T02:49:01.058Z] > authorizing via signed-in user (dev.vaultedapp@gmail.com)
[info] i  emulators: Starting emulators: functions {"metadata":{"emulator":{"name":"hub"},"message":"Starting emulators: functions"}}
[debug] [2025-11-14T02:49:01.648Z] [logging] Logging Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2025-11-14T02:49:01.648Z] assigned listening specs for emulators {"user":{"hub":[{"address":"127.0.0.1","family":"IPv4","port":4400},{"address":"::1","family":"IPv6","port":4400}],"ui":[{"address":"127.0.0.1","family":"IPv4","port":4000},{"address":"::1","family":"IPv6","port":4000}],"logging":[{"address":"127.0.0.1","family":"IPv4","port":4500}]},"metadata":{"message":"assigned listening specs for emulators"}}
[debug] [2025-11-14T02:49:01.652Z] Emulator locator file path: /var/folders/vr/q2wscbn14310myb7dqcsssqm0000gn/T/hub-dev-vaultapp.json
[debug] [2025-11-14T02:49:01.652Z] [hub] writing locator at /var/folders/vr/q2wscbn14310myb7dqcsssqm0000gn/T/hub-dev-vaultapp.json
[debug] [2025-11-14T02:49:02.204Z] [functions] Functions Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2025-11-14T02:49:02.204Z] [eventarc] Eventarc Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2025-11-14T02:49:02.204Z] [tasks] Cloud Tasks Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2025-11-14T02:49:02.204Z] late-assigned ports for functions and eventarc emulators {"user":{"hub":[{"address":"127.0.0.1","family":"IPv4","port":4400},{"address":"::1","family":"IPv6","port":4400}],"ui":[{"address":"127.0.0.1","family":"IPv4","port":4000},{"address":"::1","family":"IPv6","port":4000}],"logging":[{"address":"127.0.0.1","family":"IPv4","port":4500}],"functions":[{"address":"127.0.0.1","family":"IPv4","port":5001}],"eventarc":[{"address":"127.0.0.1","family":"IPv4","port":9299}],"tasks":[{"address":"127.0.0.1","family":"IPv4","port":9499}]},"metadata":{"message":"late-assigned ports for functions and eventarc emulators"}}
[warn] ⚠  functions: The following emulators are not running, calls to these services from the Functions emulator will affect production: apphosting, auth, firestore, database, hosting, pubsub, storage, dataconnect {"metadata":{"emulator":{"name":"functions"},"message":"The following emulators are not running, calls to these services from the Functions emulator will affect production: \u001b[1mapphosting, auth, firestore, database, hosting, pubsub, storage, dataconnect\u001b[22m"}}
[debug] [2025-11-14T02:49:02.213Z] defaultcredentials: writing to file /Users/puneet/.config/firebase/dev_vaultedapp_gmail.com_application_default_credentials.json
[debug] [2025-11-14T02:49:02.215Z] Setting GAC to /Users/puneet/.config/firebase/dev_vaultedapp_gmail.com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to /Users/puneet/.config/firebase/dev_vaultedapp_gmail.com_application_default_credentials.json"}}
[debug] [2025-11-14T02:49:02.216Z] Checked if tokens are valid: true, expires at: 1763090621536
[debug] [2025-11-14T02:49:02.216Z] Checked if tokens are valid: true, expires at: 1763090621536
[debug] [2025-11-14T02:49:02.217Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/dev-vaultapp/adminSdkConfig [none]
[debug] [2025-11-14T02:49:02.875Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/dev-vaultapp/adminSdkConfig 200
[debug] [2025-11-14T02:49:02.875Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/dev-vaultapp/adminSdkConfig {"projectId":"dev-vaultapp","databaseURL":"https://dev-vaultapp-default-rtdb.firebaseio.com","storageBucket":"dev-vaultapp.firebasestorage.app"}
[info] i  functions: Watching "/Users/puneet/workspace/vault-app/functions" for Cloud Functions... {"metadata":{"emulator":{"name":"functions"},"message":"Watching \"/Users/puneet/workspace/vault-app/functions\" for Cloud Functions..."}}
[debug] [2025-11-14T02:49:02.912Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[warn] ⚠  functions: Please note that there will be breaking changes when you upgrade. 
[debug] [2025-11-14T02:49:03.619Z] > [functions] package.json contents: {
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "16"
  },
  "main": "index.js",
  "dependencies": {
    "exceljs": "^4.4.0",
    "firebase-admin": "^9.8.0",
    "firebase-functions": "^3.14.1",
    "nodemailer": "^7.0.10"
  },
  "devDependencies": {
    "firebase-functions-test": "^0.2.0"
  },
  "private": true
}
[debug] [2025-11-14T02:49:03.619Z] Building nodejs source
[debug] [2025-11-14T02:49:03.619Z] Failed to find version of module node: reached end of search path /Users/puneet/workspace/vault-app/functions/node_modules
[warn] ⚠  functions: Your requested "node" version "16" doesn't match your global version "24". Using node@24 from host. 
[info] i  functions: You are using a version of firebase-functions SDK (3.24.1) that does not have support for the newest Firebase Extensions features. Please update firebase-functions SDK to >=5.1.0 to use them correctly 
[debug] [2025-11-14T02:49:03.621Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-11-14T02:49:03.628Z] Found firebase-functions binary at '/Users/puneet/workspace/vault-app/functions/node_modules/.bin/firebase-functions'
[info] Serving at port 8449

[debug] [2025-11-14T02:49:04.102Z] Got response from /__/functions.yaml {"endpoints":{"exportInventoryToExcel":{"platform":"gcfv1","labels":{},"callableTrigger":{},"entryPoint":"exportInventoryToExcel"}},"specVersion":"v1alpha1","requiredAPIs":[]}
[info] shutdown requested via /__/quitquitquit

[info] ✔  functions: Loaded functions definitions from source: exportInventoryToExcel. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: exportInventoryToExcel."}}
[info] ✔  functions[us-central1-exportInventoryToExcel]: http function initialized (http://127.0.0.1:5001/dev-vaultapp/us-central1/exportInventoryToExcel). {"metadata":{"emulator":{"name":"functions"},"message":"\u001b[1mhttp\u001b[22m function initialized (http://127.0.0.1:5001/dev-vaultapp/us-central1/exportInventoryToExcel)."}}
[debug] [2025-11-14T02:49:08.128Z] Could not find VSCode notification endpoint: FetchError: request to http://localhost:40001/vscode/notify failed, reason: . If you are not running the Firebase Data Connect VSCode extension, this is expected and not an issue.
[info] 
┌─────────────────────────────────────────────────────────────┐
│ ✔  All emulators ready! It is now safe to connect your app. │
│ i  View Emulator UI at http://127.0.0.1:4000/               │
└─────────────────────────────────────────────────────────────┘

┌───────────┬────────────────┬─────────────────────────────────┐
│ Emulator  │ Host:Port      │ View in Emulator UI             │
├───────────┼────────────────┼─────────────────────────────────┤
│ Functions │ 127.0.0.1:5001 │ http://127.0.0.1:4000/functions │
└───────────┴────────────────┴─────────────────────────────────┘
  Emulator Hub host: 127.0.0.1 port: 4400
  Other reserved ports: 4500

Issues? Report them at https://github.com/firebase/firebase-tools/issues and attach the *-debug.log files.
 
[debug] [2025-11-14T02:49:50.603Z] [work-queue] {"queuedWork":["/dev-vaultapp/us-central1/exportInventoryToExcel-2025-11-14T02:49:50.603Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2025-11-14T02:49:50.603Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/dev-vaultapp/us-central1/exportInventoryToExcel-2025-11-14T02:49:50.603Z"],"workRunningCount":1}
[debug] [2025-11-14T02:49:50.604Z] Accepted request GET /dev-vaultapp/us-central1/exportInventoryToExcel --> us-central1-exportInventoryToExcel
[debug] [2025-11-14T02:49:50.606Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2025-11-14T02:49:50.607Z] [functions] Got req.url=/dev-vaultapp/us-central1/exportInventoryToExcel, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/dev-vaultapp/us-central1/exportInventoryToExcel, mapping to path=/"}}
[debug] [2025-11-14T02:49:50.610Z] [worker-pool] addWorker(us-central1-exportInventoryToExcel) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-exportInventoryToExcel)"}}
[debug] [2025-11-14T02:49:50.611Z] [worker-pool] Adding worker with key us-central1-exportInventoryToExcel, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-exportInventoryToExcel, total=1"}}
[debug] [2025-11-14T02:49:51.828Z] [runtime-status] [44180] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.12.0","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [44180] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.12.0\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js\"}"}}
[debug] [2025-11-14T02:49:51.829Z] [runtime-status] [44180] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [44180] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:49:51.830Z] [runtime-status] [44180] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [44180] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2025-11-14T02:49:51.830Z] [runtime-status] [44180] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [44180] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:49:51.890Z] [runtime-status] [44180] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [44180] Checked functions.config() {\"config\":{}}"}}
[debug] [2025-11-14T02:49:51.890Z] [runtime-status] [44180] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [44180] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}}"}}
[debug] [2025-11-14T02:49:51.891Z] [runtime-status] [44180] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [44180] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:49:51.891Z] [runtime-status] [44180] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.12.0","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [44180] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.12.0\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js\"}"}}
[debug] [2025-11-14T02:49:51.892Z] [runtime-status] [44180] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [44180] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:49:51.892Z] [runtime-status] [44180] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.12.0","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [44180] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.12.0\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js\"}}"}}
[debug] [2025-11-14T02:49:52.235Z] [runtime-status] [44180] initializeApp(DEFAULT) {"storageBucket":"dev-vaultapp.firebasestorage.app","databaseURL":"https://dev-vaultapp-default-rtdb.firebaseio.com","projectId":"dev-vaultapp"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [44180] initializeApp(DEFAULT) {\"storageBucket\":\"dev-vaultapp.firebasestorage.app\",\"databaseURL\":\"https://dev-vaultapp-default-rtdb.firebaseio.com\",\"projectId\":\"dev-vaultapp\"}"}}
[warn] ⚠  functions: The Cloud Firestore emulator is not running, so calls to Firestore will affect production. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"The Cloud Firestore emulator is not running, so calls to Firestore will affect production."}}
[debug] [2025-11-14T02:49:52.263Z] [runtime-status] [44180] Functions runtime initialized. {"cwd":"/Users/puneet/workspace/vault-app/functions","node_version":"24.11.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [44180] Functions runtime initialized. {\"cwd\":\"/Users/puneet/workspace/vault-app/functions\",\"node_version\":\"24.11.0\"}"}}
[debug] [2025-11-14T02:49:52.264Z] [runtime-status] [44180] Listening to port: /var/folders/vr/q2wscbn14310myb7dqcsssqm0000gn/T/fire_emu_056344736865bf2e.sock {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [44180] Listening to port: /var/folders/vr/q2wscbn14310myb7dqcsssqm0000gn/T/fire_emu_056344736865bf2e.sock"}}
[debug] [2025-11-14T02:49:52.336Z] [worker-us-central1-exportInventoryToExcel-944cf40f-75c8-49c6-a345-dd883f2a8206]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-944cf40f-75c8-49c6-a345-dd883f2a8206]: IDLE"}}
[debug] [2025-11-14T02:49:52.336Z] [worker-pool] submitRequest(triggerId=us-central1-exportInventoryToExcel) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-exportInventoryToExcel)"}}
[info] i  functions: Beginning execution of "us-central1-exportInventoryToExcel" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Beginning execution of \"us-central1-exportInventoryToExcel\""}}
[debug] [2025-11-14T02:49:52.337Z] [worker-us-central1-exportInventoryToExcel-944cf40f-75c8-49c6-a345-dd883f2a8206]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-944cf40f-75c8-49c6-a345-dd883f2a8206]: BUSY"}}
[info] >  {"severity":"WARNING","message":"Request has invalid method. GET"} {"user":{"severity":"WARNING","message":"Request has invalid method. GET"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"severity\":\"WARNING\",\"message\":\"Request has invalid method. GET\"}"}}
[info] >  {"severity":"ERROR","message":"Invalid request, unable to process."} {"user":{"severity":"ERROR","message":"Invalid request, unable to process."},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"severity\":\"ERROR\",\"message\":\"Invalid request, unable to process.\"}"}}
[debug] [2025-11-14T02:49:52.343Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-exportInventoryToExcel" in 6.236388ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finished \"us-central1-exportInventoryToExcel\" in 6.236388ms"}}
[debug] [2025-11-14T02:49:52.343Z] [worker-us-central1-exportInventoryToExcel-944cf40f-75c8-49c6-a345-dd883f2a8206]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-944cf40f-75c8-49c6-a345-dd883f2a8206]: IDLE"}}
[debug] [2025-11-14T02:49:52.343Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2025-11-14T02:49:52.343Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2025-11-14T02:49:52.344Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2025-11-14T02:49:52.379Z] Functions emulator received unknown request at path /favicon.ico
[debug] [2025-11-14T02:50:33.696Z] File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers"}}
[debug] [2025-11-14T02:50:33.999Z] File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers"}}
[debug] [2025-11-14T02:50:34.100Z] File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers"}}
[debug] [2025-11-14T02:50:35.101Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[warn] ⚠  functions: Please note that there will be breaking changes when you upgrade. 
[debug] [2025-11-14T02:50:35.995Z] > [functions] package.json contents: {
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "16"
  },
  "main": "index.js",
  "dependencies": {
    "exceljs": "^4.4.0",
    "firebase-admin": "^9.8.0",
    "firebase-functions": "^3.14.1",
    "nodemailer": "^7.0.10"
  },
  "devDependencies": {
    "firebase-functions-test": "^0.2.0"
  },
  "private": true
}
[debug] [2025-11-14T02:50:35.995Z] Building nodejs source
[debug] [2025-11-14T02:50:35.996Z] Failed to find version of module node: reached end of search path /Users/puneet/workspace/vault-app/functions/node_modules
[warn] ⚠  functions: Your requested "node" version "16" doesn't match your global version "24". Using node@24 from host. 
[info] i  functions: You are using a version of firebase-functions SDK (3.24.1) that does not have support for the newest Firebase Extensions features. Please update firebase-functions SDK to >=5.1.0 to use them correctly 
[debug] [2025-11-14T02:50:35.996Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-11-14T02:50:35.997Z] Found firebase-functions binary at '/Users/puneet/workspace/vault-app/functions/node_modules/.bin/firebase-functions'
[info] Serving at port 8112

[debug] [2025-11-14T02:50:36.682Z] Got response from /__/functions.yaml {"endpoints":{"exportInventoryToExcel":{"platform":"gcfv1","labels":{},"callableTrigger":{},"entryPoint":"exportInventoryToExcel"}},"specVersion":"v1alpha1","requiredAPIs":[]}
[info] shutdown requested via /__/quitquitquit

[info] ✔  functions: Loaded functions definitions from source: exportInventoryToExcel. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: exportInventoryToExcel."}}
[debug] [2025-11-14T02:50:40.696Z] [worker-pool] Shutting down IDLE worker (us-central1-exportInventoryToExcel) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-exportInventoryToExcel)"}}
[debug] [2025-11-14T02:50:40.696Z] [worker-us-central1-exportInventoryToExcel-944cf40f-75c8-49c6-a345-dd883f2a8206]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-944cf40f-75c8-49c6-a345-dd883f2a8206]: FINISHING"}}
[debug] [2025-11-14T02:50:40.707Z] [worker-us-central1-exportInventoryToExcel-944cf40f-75c8-49c6-a345-dd883f2a8206]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-944cf40f-75c8-49c6-a345-dd883f2a8206]: exited"}}
[debug] [2025-11-14T02:50:40.707Z] [worker-us-central1-exportInventoryToExcel-944cf40f-75c8-49c6-a345-dd883f2a8206]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-944cf40f-75c8-49c6-a345-dd883f2a8206]: FINISHED"}}
[debug] [2025-11-14T02:51:24.807Z] [work-queue] {"queuedWork":["/dev-vaultapp/us-central1/exportInventoryToExcel-2025-11-14T02:51:24.807Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2025-11-14T02:51:24.807Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/dev-vaultapp/us-central1/exportInventoryToExcel-2025-11-14T02:51:24.807Z"],"workRunningCount":1}
[debug] [2025-11-14T02:51:24.807Z] Accepted request POST /dev-vaultapp/us-central1/exportInventoryToExcel --> us-central1-exportInventoryToExcel
[debug] [2025-11-14T02:51:24.807Z] ID Token: eyJhbGciOiJSUzI1NiIsImtpZCI6IjM4MDI5MzRmZTBlZWM0NmE1ZWQwMDA2ZDE0YTFiYWIwMWUzNDUwODMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiUHVuZWV0IFNoYXJtYSIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NJc2F3dWpkdk5qbjNhakVaMlVkWWdSS3BjYVRxbFZVSnlpR2JmT2FONU9hTExXekE9czk2LWMiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vZGV2LXZhdWx0YXBwIiwiYXVkIjoiZGV2LXZhdWx0YXBwIiwiYXV0aF90aW1lIjoxNzYyODkwNDE0LCJ1c2VyX2lkIjoiUU5SeFJTMlFoYU9CTTVPcWhpSjlZOWxMWHR1MiIsInN1YiI6IlFOUnhSUzJRaGFPQk01T3FoaUo5WTlsTFh0dTIiLCJpYXQiOjE3NjMwODc0MjEsImV4cCI6MTc2MzA5MTAyMSwiZW1haWwiOiJwdW5lZXRyYXRhbjgzQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJmaXJlYmFzZSI6eyJpZGVudGl0aWVzIjp7Imdvb2dsZS5jb20iOlsiMTE0NjE3NTIzMTQ4NzM2MDUzNzUxIl0sImVtYWlsIjpbInB1bmVldHJhdGFuODNAZ21haWwuY29tIl19LCJzaWduX2luX3Byb3ZpZGVyIjoiZ29vZ2xlLmNvbSJ9fQ.niHIfl4T4XjqGaFy8pPH1FncA5TYhIgpwKT0Ql0WQpBk4ZmJ4ZkiWClZQs-ahXzYiKS7dzDU6VvY5ArAvLqJeyaMqdXeOcAFJ8MweNmnu4QXPwTGEkbtg2xaIwTawS9X_jbHMR42k5XMChrzzC9QWEghKDECrPTJNeUErINtqsDj3HsUg97hUrVhtBhCz311Ca_8Ui3gVvsvbG5lQ1DQv6NpDIzSIP_Z5QBq7jFiI-MtXLotR3bywhcN46r1Hoqyu59oV-FNA4xBQKRmcQzIKPWuQhtAuUyYkfh2HUWNR8kvpbsypoYfyAcY0lTyWneqMsAv0kRy37cqgGkkRhZSLA
[debug] [2025-11-14T02:51:24.811Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2025-11-14T02:51:24.811Z] [functions] Got req.url=/dev-vaultapp/us-central1/exportInventoryToExcel, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/dev-vaultapp/us-central1/exportInventoryToExcel, mapping to path=/"}}
[debug] [2025-11-14T02:51:24.812Z] [worker-pool] Cleaned up workers for us-central1-exportInventoryToExcel: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-exportInventoryToExcel: 1 --> 0"}}
[debug] [2025-11-14T02:51:24.813Z] [worker-pool] addWorker(us-central1-exportInventoryToExcel) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-exportInventoryToExcel)"}}
[debug] [2025-11-14T02:51:24.813Z] [worker-pool] Adding worker with key us-central1-exportInventoryToExcel, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-exportInventoryToExcel, total=1"}}
[debug] [2025-11-14T02:51:26.006Z] [runtime-status] [45648] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.12.0","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [45648] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.12.0\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js\"}"}}
[debug] [2025-11-14T02:51:26.007Z] [runtime-status] [45648] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [45648] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:51:26.007Z] [runtime-status] [45648] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [45648] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2025-11-14T02:51:26.008Z] [runtime-status] [45648] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [45648] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:51:26.056Z] [runtime-status] [45648] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [45648] Checked functions.config() {\"config\":{}}"}}
[debug] [2025-11-14T02:51:26.056Z] [runtime-status] [45648] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [45648] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}}"}}
[debug] [2025-11-14T02:51:26.056Z] [runtime-status] [45648] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [45648] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:51:26.057Z] [runtime-status] [45648] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.12.0","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [45648] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.12.0\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js\"}"}}
[debug] [2025-11-14T02:51:26.057Z] [runtime-status] [45648] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [45648] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:51:26.057Z] [runtime-status] [45648] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.12.0","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [45648] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.12.0\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js\"}}"}}
[debug] [2025-11-14T02:51:26.393Z] [runtime-status] [45648] initializeApp(DEFAULT) {"storageBucket":"dev-vaultapp.firebasestorage.app","databaseURL":"https://dev-vaultapp-default-rtdb.firebaseio.com","projectId":"dev-vaultapp"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [45648] initializeApp(DEFAULT) {\"storageBucket\":\"dev-vaultapp.firebasestorage.app\",\"databaseURL\":\"https://dev-vaultapp-default-rtdb.firebaseio.com\",\"projectId\":\"dev-vaultapp\"}"}}
[debug] [2025-11-14T02:51:26.419Z] [runtime-status] [45648] Functions runtime initialized. {"cwd":"/Users/puneet/workspace/vault-app/functions","node_version":"24.11.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [45648] Functions runtime initialized. {\"cwd\":\"/Users/puneet/workspace/vault-app/functions\",\"node_version\":\"24.11.0\"}"}}
[debug] [2025-11-14T02:51:26.420Z] [runtime-status] [45648] Listening to port: /var/folders/vr/q2wscbn14310myb7dqcsssqm0000gn/T/fire_emu_5604e4d13e24f003.sock {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [45648] Listening to port: /var/folders/vr/q2wscbn14310myb7dqcsssqm0000gn/T/fire_emu_5604e4d13e24f003.sock"}}
[debug] [2025-11-14T02:51:26.433Z] [worker-us-central1-exportInventoryToExcel-c6e826ee-c4de-408f-8a85-e6f3f7407651]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-c6e826ee-c4de-408f-8a85-e6f3f7407651]: IDLE"}}
[debug] [2025-11-14T02:51:26.433Z] [worker-pool] submitRequest(triggerId=us-central1-exportInventoryToExcel) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-exportInventoryToExcel)"}}
[info] i  functions: Beginning execution of "us-central1-exportInventoryToExcel" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Beginning execution of \"us-central1-exportInventoryToExcel\""}}
[debug] [2025-11-14T02:51:26.434Z] [worker-us-central1-exportInventoryToExcel-c6e826ee-c4de-408f-8a85-e6f3f7407651]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-c6e826ee-c4de-408f-8a85-e6f3f7407651]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"INFO","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"INFO","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"INFO\",\"message\":\"Callable request verification passed\"}"}}
[debug] [2025-11-14T02:51:26.457Z] [runtime-status] [45648] Callable functions auth override {"key":"x-callable-context-auth","value":"%7B%22uid%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22token%22%3A%7B%22name%22%3A%22Puneet%20Sharma%22%2C%22picture%22%3A%22https%3A%2F%2Flh3.googleusercontent.com%2Fa%2FACg8ocIsawujdvNjn3ajEZ2UdYgRKpcaTqlVUJyiGbfOaN5OaLLWzA%3Ds96-c%22%2C%22iss%22%3A%22https%3A%2F%2Fsecuretoken.google.com%2Fdev-vaultapp%22%2C%22aud%22%3A%22dev-vaultapp%22%2C%22auth_time%22%3A1762890414%2C%22user_id%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22sub%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22iat%22%3A1763087421%2C%22exp%22%3A1763091021%2C%22email%22%3A%22puneetratan83%40gmail.com%22%2C%22email_verified%22%3Atrue%2C%22firebase%22%3A%7B%22identities%22%3A%7B%22google.com%22%3A%5B%22114617523148736053751%22%5D%2C%22email%22%3A%5B%22puneetratan83%40gmail.com%22%5D%7D%2C%22sign_in_provider%22%3A%22google.com%22%7D%2C%22uid%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%7D%7D"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [45648] Callable functions auth override {\"key\":\"x-callable-context-auth\",\"value\":\"%7B%22uid%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22token%22%3A%7B%22name%22%3A%22Puneet%20Sharma%22%2C%22picture%22%3A%22https%3A%2F%2Flh3.googleusercontent.com%2Fa%2FACg8ocIsawujdvNjn3ajEZ2UdYgRKpcaTqlVUJyiGbfOaN5OaLLWzA%3Ds96-c%22%2C%22iss%22%3A%22https%3A%2F%2Fsecuretoken.google.com%2Fdev-vaultapp%22%2C%22aud%22%3A%22dev-vaultapp%22%2C%22auth_time%22%3A1762890414%2C%22user_id%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22sub%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22iat%22%3A1763087421%2C%22exp%22%3A1763091021%2C%22email%22%3A%22puneetratan83%40gmail.com%22%2C%22email_verified%22%3Atrue%2C%22firebase%22%3A%7B%22identities%22%3A%7B%22google.com%22%3A%5B%22114617523148736053751%22%5D%2C%22email%22%3A%5B%22puneetratan83%40gmail.com%22%5D%7D%2C%22sign_in_provider%22%3A%22google.com%22%7D%2C%22uid%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%7D%7D\"}"}}
[warn] ⚠  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44 {"user":"Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44"}}
[warn] ⚠  Google API requested!
   - URL: "https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Google API requested!\n   - URL: \"https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44\"\n   - Be careful, this may be a production service."}}
[info] >  Fetching image: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44 {"user":"Fetching image: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Fetching image: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44"}}
[info] >  Response status: 200 {"user":"Response status: 200","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Response status: 200"}}
[info] >  Content-Type: image/png {"user":"Content-Type: image/png","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Content-Type: image/png"}}
[debug] [2025-11-14T02:51:28.206Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-exportInventoryToExcel" in 1772.310899ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finished \"us-central1-exportInventoryToExcel\" in 1772.310899ms"}}
[debug] [2025-11-14T02:51:28.206Z] [worker-us-central1-exportInventoryToExcel-c6e826ee-c4de-408f-8a85-e6f3f7407651]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-c6e826ee-c4de-408f-8a85-e6f3f7407651]: IDLE"}}
[debug] [2025-11-14T02:51:28.206Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2025-11-14T02:51:28.206Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2025-11-14T02:51:28.206Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2025-11-14T02:52:16.848Z] File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers"}}
[debug] [2025-11-14T02:52:17.849Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[warn] ⚠  functions: Please note that there will be breaking changes when you upgrade. 
[debug] [2025-11-14T02:52:18.751Z] > [functions] package.json contents: {
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "16"
  },
  "main": "index.js",
  "dependencies": {
    "exceljs": "^4.4.0",
    "firebase-admin": "^9.8.0",
    "firebase-functions": "^3.14.1",
    "nodemailer": "^7.0.10"
  },
  "devDependencies": {
    "firebase-functions-test": "^0.2.0"
  },
  "private": true
}
[debug] [2025-11-14T02:52:18.751Z] Building nodejs source
[debug] [2025-11-14T02:52:18.751Z] Failed to find version of module node: reached end of search path /Users/puneet/workspace/vault-app/functions/node_modules
[warn] ⚠  functions: Your requested "node" version "16" doesn't match your global version "24". Using node@24 from host. 
[info] i  functions: You are using a version of firebase-functions SDK (3.24.1) that does not have support for the newest Firebase Extensions features. Please update firebase-functions SDK to >=5.1.0 to use them correctly 
[debug] [2025-11-14T02:52:18.751Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-11-14T02:52:18.753Z] Found firebase-functions binary at '/Users/puneet/workspace/vault-app/functions/node_modules/.bin/firebase-functions'
[info] Serving at port 8270

[debug] [2025-11-14T02:52:19.501Z] Got response from /__/functions.yaml {"endpoints":{"exportInventoryToExcel":{"platform":"gcfv1","labels":{},"callableTrigger":{},"entryPoint":"exportInventoryToExcel"}},"specVersion":"v1alpha1","requiredAPIs":[]}
[info] shutdown requested via /__/quitquitquit

[info] ✔  functions: Loaded functions definitions from source: exportInventoryToExcel. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: exportInventoryToExcel."}}
[debug] [2025-11-14T02:52:23.518Z] [worker-pool] Shutting down IDLE worker (us-central1-exportInventoryToExcel) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-exportInventoryToExcel)"}}
[debug] [2025-11-14T02:52:23.518Z] [worker-us-central1-exportInventoryToExcel-c6e826ee-c4de-408f-8a85-e6f3f7407651]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-c6e826ee-c4de-408f-8a85-e6f3f7407651]: FINISHING"}}
[debug] [2025-11-14T02:52:23.533Z] [worker-us-central1-exportInventoryToExcel-c6e826ee-c4de-408f-8a85-e6f3f7407651]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-c6e826ee-c4de-408f-8a85-e6f3f7407651]: exited"}}
[debug] [2025-11-14T02:52:23.533Z] [worker-us-central1-exportInventoryToExcel-c6e826ee-c4de-408f-8a85-e6f3f7407651]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-c6e826ee-c4de-408f-8a85-e6f3f7407651]: FINISHED"}}
[debug] [2025-11-14T02:52:25.547Z] [work-queue] {"queuedWork":["/dev-vaultapp/us-central1/exportInventoryToExcel-2025-11-14T02:52:25.547Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2025-11-14T02:52:25.547Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/dev-vaultapp/us-central1/exportInventoryToExcel-2025-11-14T02:52:25.547Z"],"workRunningCount":1}
[debug] [2025-11-14T02:52:25.547Z] Accepted request POST /dev-vaultapp/us-central1/exportInventoryToExcel --> us-central1-exportInventoryToExcel
[debug] [2025-11-14T02:52:25.547Z] ID Token: eyJhbGciOiJSUzI1NiIsImtpZCI6IjM4MDI5MzRmZTBlZWM0NmE1ZWQwMDA2ZDE0YTFiYWIwMWUzNDUwODMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiUHVuZWV0IFNoYXJtYSIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NJc2F3dWpkdk5qbjNhakVaMlVkWWdSS3BjYVRxbFZVSnlpR2JmT2FONU9hTExXekE9czk2LWMiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vZGV2LXZhdWx0YXBwIiwiYXVkIjoiZGV2LXZhdWx0YXBwIiwiYXV0aF90aW1lIjoxNzYyODkwNDE0LCJ1c2VyX2lkIjoiUU5SeFJTMlFoYU9CTTVPcWhpSjlZOWxMWHR1MiIsInN1YiI6IlFOUnhSUzJRaGFPQk01T3FoaUo5WTlsTFh0dTIiLCJpYXQiOjE3NjMwODc0MjEsImV4cCI6MTc2MzA5MTAyMSwiZW1haWwiOiJwdW5lZXRyYXRhbjgzQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJmaXJlYmFzZSI6eyJpZGVudGl0aWVzIjp7Imdvb2dsZS5jb20iOlsiMTE0NjE3NTIzMTQ4NzM2MDUzNzUxIl0sImVtYWlsIjpbInB1bmVldHJhdGFuODNAZ21haWwuY29tIl19LCJzaWduX2luX3Byb3ZpZGVyIjoiZ29vZ2xlLmNvbSJ9fQ.niHIfl4T4XjqGaFy8pPH1FncA5TYhIgpwKT0Ql0WQpBk4ZmJ4ZkiWClZQs-ahXzYiKS7dzDU6VvY5ArAvLqJeyaMqdXeOcAFJ8MweNmnu4QXPwTGEkbtg2xaIwTawS9X_jbHMR42k5XMChrzzC9QWEghKDECrPTJNeUErINtqsDj3HsUg97hUrVhtBhCz311Ca_8Ui3gVvsvbG5lQ1DQv6NpDIzSIP_Z5QBq7jFiI-MtXLotR3bywhcN46r1Hoqyu59oV-FNA4xBQKRmcQzIKPWuQhtAuUyYkfh2HUWNR8kvpbsypoYfyAcY0lTyWneqMsAv0kRy37cqgGkkRhZSLA
[debug] [2025-11-14T02:52:25.549Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2025-11-14T02:52:25.549Z] [functions] Got req.url=/dev-vaultapp/us-central1/exportInventoryToExcel, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/dev-vaultapp/us-central1/exportInventoryToExcel, mapping to path=/"}}
[debug] [2025-11-14T02:52:25.549Z] [worker-pool] Cleaned up workers for us-central1-exportInventoryToExcel: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-exportInventoryToExcel: 1 --> 0"}}
[debug] [2025-11-14T02:52:25.550Z] [worker-pool] addWorker(us-central1-exportInventoryToExcel) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-exportInventoryToExcel)"}}
[debug] [2025-11-14T02:52:25.550Z] [worker-pool] Adding worker with key us-central1-exportInventoryToExcel, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-exportInventoryToExcel, total=1"}}
[debug] [2025-11-14T02:52:26.715Z] [runtime-status] [46648] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.12.0","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [46648] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.12.0\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js\"}"}}
[debug] [2025-11-14T02:52:26.716Z] [runtime-status] [46648] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [46648] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:52:26.716Z] [runtime-status] [46648] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [46648] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2025-11-14T02:52:26.717Z] [runtime-status] [46648] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [46648] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:52:26.741Z] [runtime-status] [46648] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [46648] Checked functions.config() {\"config\":{}}"}}
[debug] [2025-11-14T02:52:26.741Z] [runtime-status] [46648] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [46648] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}}"}}
[debug] [2025-11-14T02:52:26.742Z] [runtime-status] [46648] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [46648] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:52:26.742Z] [runtime-status] [46648] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.12.0","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [46648] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.12.0\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js\"}"}}
[debug] [2025-11-14T02:52:26.743Z] [runtime-status] [46648] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [46648] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:52:26.743Z] [runtime-status] [46648] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.12.0","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [46648] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.12.0\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js\"}}"}}
[debug] [2025-11-14T02:52:26.928Z] [runtime-status] [46648] initializeApp(DEFAULT) {"storageBucket":"dev-vaultapp.firebasestorage.app","databaseURL":"https://dev-vaultapp-default-rtdb.firebaseio.com","projectId":"dev-vaultapp"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [46648] initializeApp(DEFAULT) {\"storageBucket\":\"dev-vaultapp.firebasestorage.app\",\"databaseURL\":\"https://dev-vaultapp-default-rtdb.firebaseio.com\",\"projectId\":\"dev-vaultapp\"}"}}
[debug] [2025-11-14T02:52:26.944Z] [runtime-status] [46648] Functions runtime initialized. {"cwd":"/Users/puneet/workspace/vault-app/functions","node_version":"24.11.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [46648] Functions runtime initialized. {\"cwd\":\"/Users/puneet/workspace/vault-app/functions\",\"node_version\":\"24.11.0\"}"}}
[debug] [2025-11-14T02:52:26.944Z] [runtime-status] [46648] Listening to port: /var/folders/vr/q2wscbn14310myb7dqcsssqm0000gn/T/fire_emu_1ddc4844861f9487.sock {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [46648] Listening to port: /var/folders/vr/q2wscbn14310myb7dqcsssqm0000gn/T/fire_emu_1ddc4844861f9487.sock"}}
[debug] [2025-11-14T02:52:26.966Z] [worker-us-central1-exportInventoryToExcel-14411f5b-971d-4f76-9f0c-0d28c5d077b9]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-14411f5b-971d-4f76-9f0c-0d28c5d077b9]: IDLE"}}
[debug] [2025-11-14T02:52:26.966Z] [worker-pool] submitRequest(triggerId=us-central1-exportInventoryToExcel) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-exportInventoryToExcel)"}}
[info] i  functions: Beginning execution of "us-central1-exportInventoryToExcel" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Beginning execution of \"us-central1-exportInventoryToExcel\""}}
[debug] [2025-11-14T02:52:26.967Z] [worker-us-central1-exportInventoryToExcel-14411f5b-971d-4f76-9f0c-0d28c5d077b9]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-14411f5b-971d-4f76-9f0c-0d28c5d077b9]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"INFO","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"INFO","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"INFO\",\"message\":\"Callable request verification passed\"}"}}
[debug] [2025-11-14T02:52:26.981Z] [runtime-status] [46648] Callable functions auth override {"key":"x-callable-context-auth","value":"%7B%22uid%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22token%22%3A%7B%22name%22%3A%22Puneet%20Sharma%22%2C%22picture%22%3A%22https%3A%2F%2Flh3.googleusercontent.com%2Fa%2FACg8ocIsawujdvNjn3ajEZ2UdYgRKpcaTqlVUJyiGbfOaN5OaLLWzA%3Ds96-c%22%2C%22iss%22%3A%22https%3A%2F%2Fsecuretoken.google.com%2Fdev-vaultapp%22%2C%22aud%22%3A%22dev-vaultapp%22%2C%22auth_time%22%3A1762890414%2C%22user_id%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22sub%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22iat%22%3A1763087421%2C%22exp%22%3A1763091021%2C%22email%22%3A%22puneetratan83%40gmail.com%22%2C%22email_verified%22%3Atrue%2C%22firebase%22%3A%7B%22identities%22%3A%7B%22google.com%22%3A%5B%22114617523148736053751%22%5D%2C%22email%22%3A%5B%22puneetratan83%40gmail.com%22%5D%7D%2C%22sign_in_provider%22%3A%22google.com%22%7D%2C%22uid%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%7D%7D"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [46648] Callable functions auth override {\"key\":\"x-callable-context-auth\",\"value\":\"%7B%22uid%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22token%22%3A%7B%22name%22%3A%22Puneet%20Sharma%22%2C%22picture%22%3A%22https%3A%2F%2Flh3.googleusercontent.com%2Fa%2FACg8ocIsawujdvNjn3ajEZ2UdYgRKpcaTqlVUJyiGbfOaN5OaLLWzA%3Ds96-c%22%2C%22iss%22%3A%22https%3A%2F%2Fsecuretoken.google.com%2Fdev-vaultapp%22%2C%22aud%22%3A%22dev-vaultapp%22%2C%22auth_time%22%3A1762890414%2C%22user_id%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22sub%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22iat%22%3A1763087421%2C%22exp%22%3A1763091021%2C%22email%22%3A%22puneetratan83%40gmail.com%22%2C%22email_verified%22%3Atrue%2C%22firebase%22%3A%7B%22identities%22%3A%7B%22google.com%22%3A%5B%22114617523148736053751%22%5D%2C%22email%22%3A%5B%22puneetratan83%40gmail.com%22%5D%7D%2C%22sign_in_provider%22%3A%22google.com%22%7D%2C%22uid%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%7D%7D\"}"}}
[warn] ⚠  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44 {"user":"Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44"}}
[warn] ⚠  Google API requested!
   - URL: "https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Google API requested!\n   - URL: \"https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44\"\n   - Be careful, this may be a production service."}}
[info] >  Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44 {"user":"Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44"}}
[info] >  Response status-2: 200 {"user":"Response status-2: 200","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Response status-2: 200"}}
[info] >  Content-Type-3: image/png {"user":"Content-Type-3: image/png","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Content-Type-3: image/png"}}
[debug] [2025-11-14T02:52:28.422Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-exportInventoryToExcel" in 1455.599904ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finished \"us-central1-exportInventoryToExcel\" in 1455.599904ms"}}
[debug] [2025-11-14T02:52:28.422Z] [worker-us-central1-exportInventoryToExcel-14411f5b-971d-4f76-9f0c-0d28c5d077b9]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-14411f5b-971d-4f76-9f0c-0d28c5d077b9]: IDLE"}}
[debug] [2025-11-14T02:52:28.422Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2025-11-14T02:52:28.422Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2025-11-14T02:52:28.422Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2025-11-14T02:53:07.494Z] File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers"}}
[debug] [2025-11-14T02:53:07.795Z] File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers"}}
[debug] [2025-11-14T02:53:08.797Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[warn] ⚠  functions: Please note that there will be breaking changes when you upgrade. 
[debug] [2025-11-14T02:53:09.762Z] > [functions] package.json contents: {
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "16"
  },
  "main": "index.js",
  "dependencies": {
    "exceljs": "^4.4.0",
    "firebase-admin": "^9.8.0",
    "firebase-functions": "^3.14.1",
    "nodemailer": "^7.0.10"
  },
  "devDependencies": {
    "firebase-functions-test": "^0.2.0"
  },
  "private": true
}
[debug] [2025-11-14T02:53:09.762Z] Building nodejs source
[debug] [2025-11-14T02:53:09.762Z] Failed to find version of module node: reached end of search path /Users/puneet/workspace/vault-app/functions/node_modules
[warn] ⚠  functions: Your requested "node" version "16" doesn't match your global version "24". Using node@24 from host. 
[info] i  functions: You are using a version of firebase-functions SDK (3.24.1) that does not have support for the newest Firebase Extensions features. Please update firebase-functions SDK to >=5.1.0 to use them correctly 
[debug] [2025-11-14T02:53:09.763Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-11-14T02:53:09.764Z] Found firebase-functions binary at '/Users/puneet/workspace/vault-app/functions/node_modules/.bin/firebase-functions'
[info] Serving at port 8816

[debug] [2025-11-14T02:53:10.429Z] Got response from /__/functions.yaml {"endpoints":{"exportInventoryToExcel":{"platform":"gcfv1","labels":{},"callableTrigger":{},"entryPoint":"exportInventoryToExcel"}},"specVersion":"v1alpha1","requiredAPIs":[]}
[info] shutdown requested via /__/quitquitquit

[info] ✔  functions: Loaded functions definitions from source: exportInventoryToExcel. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: exportInventoryToExcel."}}
[debug] [2025-11-14T02:53:14.442Z] [worker-pool] Shutting down IDLE worker (us-central1-exportInventoryToExcel) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-exportInventoryToExcel)"}}
[debug] [2025-11-14T02:53:14.442Z] [worker-us-central1-exportInventoryToExcel-14411f5b-971d-4f76-9f0c-0d28c5d077b9]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-14411f5b-971d-4f76-9f0c-0d28c5d077b9]: FINISHING"}}
[debug] [2025-11-14T02:53:14.457Z] [worker-us-central1-exportInventoryToExcel-14411f5b-971d-4f76-9f0c-0d28c5d077b9]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-14411f5b-971d-4f76-9f0c-0d28c5d077b9]: exited"}}
[debug] [2025-11-14T02:53:14.457Z] [worker-us-central1-exportInventoryToExcel-14411f5b-971d-4f76-9f0c-0d28c5d077b9]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-14411f5b-971d-4f76-9f0c-0d28c5d077b9]: FINISHED"}}
[debug] [2025-11-14T02:53:24.054Z] [work-queue] {"queuedWork":["/dev-vaultapp/us-central1/exportInventoryToExcel-2025-11-14T02:53:24.054Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2025-11-14T02:53:24.054Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/dev-vaultapp/us-central1/exportInventoryToExcel-2025-11-14T02:53:24.054Z"],"workRunningCount":1}
[debug] [2025-11-14T02:53:24.054Z] Accepted request POST /dev-vaultapp/us-central1/exportInventoryToExcel --> us-central1-exportInventoryToExcel
[debug] [2025-11-14T02:53:24.054Z] ID Token: eyJhbGciOiJSUzI1NiIsImtpZCI6IjM4MDI5MzRmZTBlZWM0NmE1ZWQwMDA2ZDE0YTFiYWIwMWUzNDUwODMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiUHVuZWV0IFNoYXJtYSIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NJc2F3dWpkdk5qbjNhakVaMlVkWWdSS3BjYVRxbFZVSnlpR2JmT2FONU9hTExXekE9czk2LWMiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vZGV2LXZhdWx0YXBwIiwiYXVkIjoiZGV2LXZhdWx0YXBwIiwiYXV0aF90aW1lIjoxNzYyODkwNDE0LCJ1c2VyX2lkIjoiUU5SeFJTMlFoYU9CTTVPcWhpSjlZOWxMWHR1MiIsInN1YiI6IlFOUnhSUzJRaGFPQk01T3FoaUo5WTlsTFh0dTIiLCJpYXQiOjE3NjMwODc0MjEsImV4cCI6MTc2MzA5MTAyMSwiZW1haWwiOiJwdW5lZXRyYXRhbjgzQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJmaXJlYmFzZSI6eyJpZGVudGl0aWVzIjp7Imdvb2dsZS5jb20iOlsiMTE0NjE3NTIzMTQ4NzM2MDUzNzUxIl0sImVtYWlsIjpbInB1bmVldHJhdGFuODNAZ21haWwuY29tIl19LCJzaWduX2luX3Byb3ZpZGVyIjoiZ29vZ2xlLmNvbSJ9fQ.niHIfl4T4XjqGaFy8pPH1FncA5TYhIgpwKT0Ql0WQpBk4ZmJ4ZkiWClZQs-ahXzYiKS7dzDU6VvY5ArAvLqJeyaMqdXeOcAFJ8MweNmnu4QXPwTGEkbtg2xaIwTawS9X_jbHMR42k5XMChrzzC9QWEghKDECrPTJNeUErINtqsDj3HsUg97hUrVhtBhCz311Ca_8Ui3gVvsvbG5lQ1DQv6NpDIzSIP_Z5QBq7jFiI-MtXLotR3bywhcN46r1Hoqyu59oV-FNA4xBQKRmcQzIKPWuQhtAuUyYkfh2HUWNR8kvpbsypoYfyAcY0lTyWneqMsAv0kRy37cqgGkkRhZSLA
[debug] [2025-11-14T02:53:24.057Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2025-11-14T02:53:24.057Z] [functions] Got req.url=/dev-vaultapp/us-central1/exportInventoryToExcel, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/dev-vaultapp/us-central1/exportInventoryToExcel, mapping to path=/"}}
[debug] [2025-11-14T02:53:24.058Z] [worker-pool] Cleaned up workers for us-central1-exportInventoryToExcel: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-exportInventoryToExcel: 1 --> 0"}}
[debug] [2025-11-14T02:53:24.060Z] [worker-pool] addWorker(us-central1-exportInventoryToExcel) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-exportInventoryToExcel)"}}
[debug] [2025-11-14T02:53:24.060Z] [worker-pool] Adding worker with key us-central1-exportInventoryToExcel, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-exportInventoryToExcel, total=1"}}
[debug] [2025-11-14T02:53:25.265Z] [runtime-status] [47559] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.12.0","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [47559] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.12.0\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js\"}"}}
[debug] [2025-11-14T02:53:25.265Z] [runtime-status] [47559] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [47559] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:53:25.266Z] [runtime-status] [47559] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [47559] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2025-11-14T02:53:25.266Z] [runtime-status] [47559] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [47559] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:53:25.293Z] [runtime-status] [47559] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [47559] Checked functions.config() {\"config\":{}}"}}
[debug] [2025-11-14T02:53:25.294Z] [runtime-status] [47559] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [47559] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}}"}}
[debug] [2025-11-14T02:53:25.294Z] [runtime-status] [47559] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [47559] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:53:25.295Z] [runtime-status] [47559] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.12.0","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [47559] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.12.0\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js\"}"}}
[debug] [2025-11-14T02:53:25.295Z] [runtime-status] [47559] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.24.1","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [47559] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.24.1\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-functions/lib/index.js\"}"}}
[debug] [2025-11-14T02:53:25.295Z] [runtime-status] [47559] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.12.0","resolution":"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [47559] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.12.0\",\"resolution\":\"/Users/puneet/workspace/vault-app/functions/node_modules/firebase-admin/lib/index.js\"}}"}}
[debug] [2025-11-14T02:53:25.466Z] [runtime-status] [47559] initializeApp(DEFAULT) {"storageBucket":"dev-vaultapp.firebasestorage.app","databaseURL":"https://dev-vaultapp-default-rtdb.firebaseio.com","projectId":"dev-vaultapp"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [47559] initializeApp(DEFAULT) {\"storageBucket\":\"dev-vaultapp.firebasestorage.app\",\"databaseURL\":\"https://dev-vaultapp-default-rtdb.firebaseio.com\",\"projectId\":\"dev-vaultapp\"}"}}
[debug] [2025-11-14T02:53:25.481Z] [runtime-status] [47559] Functions runtime initialized. {"cwd":"/Users/puneet/workspace/vault-app/functions","node_version":"24.11.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [47559] Functions runtime initialized. {\"cwd\":\"/Users/puneet/workspace/vault-app/functions\",\"node_version\":\"24.11.0\"}"}}
[debug] [2025-11-14T02:53:25.481Z] [runtime-status] [47559] Listening to port: /var/folders/vr/q2wscbn14310myb7dqcsssqm0000gn/T/fire_emu_3f0f8a35b68aed76.sock {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [47559] Listening to port: /var/folders/vr/q2wscbn14310myb7dqcsssqm0000gn/T/fire_emu_3f0f8a35b68aed76.sock"}}
[debug] [2025-11-14T02:53:25.579Z] [worker-us-central1-exportInventoryToExcel-66d19f0e-d0d1-40d9-8891-2bd0bb091b6c]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-66d19f0e-d0d1-40d9-8891-2bd0bb091b6c]: IDLE"}}
[debug] [2025-11-14T02:53:25.579Z] [worker-pool] submitRequest(triggerId=us-central1-exportInventoryToExcel) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-exportInventoryToExcel)"}}
[info] i  functions: Beginning execution of "us-central1-exportInventoryToExcel" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Beginning execution of \"us-central1-exportInventoryToExcel\""}}
[debug] [2025-11-14T02:53:25.579Z] [worker-us-central1-exportInventoryToExcel-66d19f0e-d0d1-40d9-8891-2bd0bb091b6c]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-66d19f0e-d0d1-40d9-8891-2bd0bb091b6c]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"INFO","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"INFO","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"INFO\",\"message\":\"Callable request verification passed\"}"}}
[debug] [2025-11-14T02:53:25.598Z] [runtime-status] [47559] Callable functions auth override {"key":"x-callable-context-auth","value":"%7B%22uid%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22token%22%3A%7B%22name%22%3A%22Puneet%20Sharma%22%2C%22picture%22%3A%22https%3A%2F%2Flh3.googleusercontent.com%2Fa%2FACg8ocIsawujdvNjn3ajEZ2UdYgRKpcaTqlVUJyiGbfOaN5OaLLWzA%3Ds96-c%22%2C%22iss%22%3A%22https%3A%2F%2Fsecuretoken.google.com%2Fdev-vaultapp%22%2C%22aud%22%3A%22dev-vaultapp%22%2C%22auth_time%22%3A1762890414%2C%22user_id%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22sub%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22iat%22%3A1763087421%2C%22exp%22%3A1763091021%2C%22email%22%3A%22puneetratan83%40gmail.com%22%2C%22email_verified%22%3Atrue%2C%22firebase%22%3A%7B%22identities%22%3A%7B%22google.com%22%3A%5B%22114617523148736053751%22%5D%2C%22email%22%3A%5B%22puneetratan83%40gmail.com%22%5D%7D%2C%22sign_in_provider%22%3A%22google.com%22%7D%2C%22uid%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%7D%7D"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[runtime-status] [47559] Callable functions auth override {\"key\":\"x-callable-context-auth\",\"value\":\"%7B%22uid%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22token%22%3A%7B%22name%22%3A%22Puneet%20Sharma%22%2C%22picture%22%3A%22https%3A%2F%2Flh3.googleusercontent.com%2Fa%2FACg8ocIsawujdvNjn3ajEZ2UdYgRKpcaTqlVUJyiGbfOaN5OaLLWzA%3Ds96-c%22%2C%22iss%22%3A%22https%3A%2F%2Fsecuretoken.google.com%2Fdev-vaultapp%22%2C%22aud%22%3A%22dev-vaultapp%22%2C%22auth_time%22%3A1762890414%2C%22user_id%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22sub%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%2C%22iat%22%3A1763087421%2C%22exp%22%3A1763091021%2C%22email%22%3A%22puneetratan83%40gmail.com%22%2C%22email_verified%22%3Atrue%2C%22firebase%22%3A%7B%22identities%22%3A%7B%22google.com%22%3A%5B%22114617523148736053751%22%5D%2C%22email%22%3A%5B%22puneetratan83%40gmail.com%22%5D%7D%2C%22sign_in_provider%22%3A%22google.com%22%7D%2C%22uid%22%3A%22QNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%22%7D%7D\"}"}}
[warn] ⚠  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44 {"user":"Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44"}}
[warn] ⚠  Google API requested!
   - URL: "https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Google API requested!\n   - URL: \"https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44\"\n   - Be careful, this may be a production service."}}
[info] >  Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44 {"user":"Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990177149_D32F153E-F9F1-438F-959A-143854B3E65A.png?alt=media&token=722bbe3c-3d8e-4a28-810c-43a9c760de44"}}
[info] >  Response status-2: 200 {"user":"Response status-2: 200","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Response status-2: 200"}}
[info] >  Content-Type-3: image/png {"user":"Content-Type-3: image/png","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Content-Type-3: image/png"}}
[info] >  Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990365882_3B9D69A3-D96A-46CD-8E6A-0E536A848B90.png?alt=media&token=5a03f7d8-c995-446b-a0eb-d6e35ef349eb {"user":"Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990365882_3B9D69A3-D96A-46CD-8E6A-0E536A848B90.png?alt=media&token=5a03f7d8-c995-446b-a0eb-d6e35ef349eb","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990365882_3B9D69A3-D96A-46CD-8E6A-0E536A848B90.png?alt=media&token=5a03f7d8-c995-446b-a0eb-d6e35ef349eb"}}
[warn] ⚠  Google API requested!
   - URL: "https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990365882_3B9D69A3-D96A-46CD-8E6A-0E536A848B90.png?alt=media&token=5a03f7d8-c995-446b-a0eb-d6e35ef349eb"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Google API requested!\n   - URL: \"https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990365882_3B9D69A3-D96A-46CD-8E6A-0E536A848B90.png?alt=media&token=5a03f7d8-c995-446b-a0eb-d6e35ef349eb\"\n   - Be careful, this may be a production service."}}
[info] >  Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990365882_3B9D69A3-D96A-46CD-8E6A-0E536A848B90.png?alt=media&token=5a03f7d8-c995-446b-a0eb-d6e35ef349eb {"user":"Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990365882_3B9D69A3-D96A-46CD-8E6A-0E536A848B90.png?alt=media&token=5a03f7d8-c995-446b-a0eb-d6e35ef349eb","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990365882_3B9D69A3-D96A-46CD-8E6A-0E536A848B90.png?alt=media&token=5a03f7d8-c995-446b-a0eb-d6e35ef349eb"}}
[info] >  Response status-2: 200 {"user":"Response status-2: 200","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Response status-2: 200"}}
[info] >  Content-Type-3: image/png {"user":"Content-Type-3: image/png","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Content-Type-3: image/png"}}
[info] >  Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762741744369_2A54C40F-D65C-4A07-AF90-6144EC7855E2.png?alt=media&token=5d68e77c-666f-4be0-9aee-a3b6e2b03fb6 {"user":"Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762741744369_2A54C40F-D65C-4A07-AF90-6144EC7855E2.png?alt=media&token=5d68e77c-666f-4be0-9aee-a3b6e2b03fb6","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762741744369_2A54C40F-D65C-4A07-AF90-6144EC7855E2.png?alt=media&token=5d68e77c-666f-4be0-9aee-a3b6e2b03fb6"}}
[warn] ⚠  Google API requested!
   - URL: "https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762741744369_2A54C40F-D65C-4A07-AF90-6144EC7855E2.png?alt=media&token=5d68e77c-666f-4be0-9aee-a3b6e2b03fb6"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Google API requested!\n   - URL: \"https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762741744369_2A54C40F-D65C-4A07-AF90-6144EC7855E2.png?alt=media&token=5d68e77c-666f-4be0-9aee-a3b6e2b03fb6\"\n   - Be careful, this may be a production service."}}
[info] >  Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762741744369_2A54C40F-D65C-4A07-AF90-6144EC7855E2.png?alt=media&token=5d68e77c-666f-4be0-9aee-a3b6e2b03fb6 {"user":"Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762741744369_2A54C40F-D65C-4A07-AF90-6144EC7855E2.png?alt=media&token=5d68e77c-666f-4be0-9aee-a3b6e2b03fb6","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762741744369_2A54C40F-D65C-4A07-AF90-6144EC7855E2.png?alt=media&token=5d68e77c-666f-4be0-9aee-a3b6e2b03fb6"}}
[info] >  Response status-2: 200 {"user":"Response status-2: 200","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Response status-2: 200"}}
[info] >  Content-Type-3: image/png {"user":"Content-Type-3: image/png","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Content-Type-3: image/png"}}
[info] >  Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990267663_829119B2-6DA1-4C82-87F7-71DD3DFD893F.png?alt=media&token=7fc9f240-adbe-4321-88bf-44e06ba0a141 {"user":"Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990267663_829119B2-6DA1-4C82-87F7-71DD3DFD893F.png?alt=media&token=7fc9f240-adbe-4321-88bf-44e06ba0a141","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990267663_829119B2-6DA1-4C82-87F7-71DD3DFD893F.png?alt=media&token=7fc9f240-adbe-4321-88bf-44e06ba0a141"}}
[warn] ⚠  Google API requested!
   - URL: "https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990267663_829119B2-6DA1-4C82-87F7-71DD3DFD893F.png?alt=media&token=7fc9f240-adbe-4321-88bf-44e06ba0a141"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Google API requested!\n   - URL: \"https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990267663_829119B2-6DA1-4C82-87F7-71DD3DFD893F.png?alt=media&token=7fc9f240-adbe-4321-88bf-44e06ba0a141\"\n   - Be careful, this may be a production service."}}
[info] >  Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990267663_829119B2-6DA1-4C82-87F7-71DD3DFD893F.png?alt=media&token=7fc9f240-adbe-4321-88bf-44e06ba0a141 {"user":"Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990267663_829119B2-6DA1-4C82-87F7-71DD3DFD893F.png?alt=media&token=7fc9f240-adbe-4321-88bf-44e06ba0a141","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762990267663_829119B2-6DA1-4C82-87F7-71DD3DFD893F.png?alt=media&token=7fc9f240-adbe-4321-88bf-44e06ba0a141"}}
[info] >  Response status-2: 200 {"user":"Response status-2: 200","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Response status-2: 200"}}
[info] >  Content-Type-3: image/png {"user":"Content-Type-3: image/png","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Content-Type-3: image/png"}}
[info] >  Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762979487542_6B1BEB55-D697-4662-9DFC-E6373D963301.png?alt=media&token=4926d31d-96f6-44dd-9a20-00fe28413d59 {"user":"Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762979487542_6B1BEB55-D697-4662-9DFC-E6373D963301.png?alt=media&token=4926d31d-96f6-44dd-9a20-00fe28413d59","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Image Download URL: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762979487542_6B1BEB55-D697-4662-9DFC-E6373D963301.png?alt=media&token=4926d31d-96f6-44dd-9a20-00fe28413d59"}}
[warn] ⚠  Google API requested!
   - URL: "https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762979487542_6B1BEB55-D697-4662-9DFC-E6373D963301.png?alt=media&token=4926d31d-96f6-44dd-9a20-00fe28413d59"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Google API requested!\n   - URL: \"https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762979487542_6B1BEB55-D697-4662-9DFC-E6373D963301.png?alt=media&token=4926d31d-96f6-44dd-9a20-00fe28413d59\"\n   - Be careful, this may be a production service."}}
[info] >  Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762979487542_6B1BEB55-D697-4662-9DFC-E6373D963301.png?alt=media&token=4926d31d-96f6-44dd-9a20-00fe28413d59 {"user":"Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762979487542_6B1BEB55-D697-4662-9DFC-E6373D963301.png?alt=media&token=4926d31d-96f6-44dd-9a20-00fe28413d59","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Fetching image-1: https://firebasestorage.googleapis.com/v0/b/dev-vaultapp.firebasestorage.app/o/inventory%2FQNRxRS2QhaOBM5OqhiJ9Y9lLXtu2%2F1762979487542_6B1BEB55-D697-4662-9DFC-E6373D963301.png?alt=media&token=4926d31d-96f6-44dd-9a20-00fe28413d59"}}
[info] >  Response status-2: 200 {"user":"Response status-2: 200","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Response status-2: 200"}}
[info] >  Content-Type-3: image/png {"user":"Content-Type-3: image/png","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Content-Type-3: image/png"}}
[info] >  after buffer.... {"user":"after buffer....","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m after buffer...."}}
[info] >  Mail Options: { {"user":"Mail Options: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m Mail Options: {"}}
[info] >    from: 'puneetratan83@gmail.com', {"user":"  from: 'puneetratan83@gmail.com',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m   from: 'puneetratan83@gmail.com',"}}
[info] >    to: 'puneetsiet@gmail.com', {"user":"  to: 'puneetsiet@gmail.com',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m   to: 'puneetsiet@gmail.com',"}}
[info] >    subject: 'Your Inventory Export', {"user":"  subject: 'Your Inventory Export',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m   subject: 'Your Inventory Export',"}}
[info] >    text: 'Attached is your exported inventory report.', {"user":"  text: 'Attached is your exported inventory report.',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m   text: 'Attached is your exported inventory report.',"}}
[info] >    attachments: [ {"user":"  attachments: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m   attachments: ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        filename: 'inventory_1763088808527.xlsx', {"user":"      filename: 'inventory_1763088808527.xlsx',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m       filename: 'inventory_1763088808527.xlsx',"}}
[info] >        content: <Buffer 50 4b 03 04 0a 00 00 00 08 00 ae 16 6e 5b 10 cc a3 d7 6d 01 00 00 9c 05 00 00 13 00 00 00 5b 43 6f 6e 74 65 6e 74 5f 54 79 70 65 73 5d 2e 78 6d 6c ad ... 4270761 more bytes> {"user":"      content: <Buffer 50 4b 03 04 0a 00 00 00 08 00 ae 16 6e 5b 10 cc a3 d7 6d 01 00 00 9c 05 00 00 13 00 00 00 5b 43 6f 6e 74 65 6e 74 5f 54 79 70 65 73 5d 2e 78 6d 6c ad ... 4270761 more bytes>","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m       content: <Buffer 50 4b 03 04 0a 00 00 00 08 00 ae 16 6e 5b 10 cc a3 d7 6d 01 00 00 9c 05 00 00 13 00 00 00 5b 43 6f 6e 74 65 6e 74 5f 54 79 70 65 73 5d 2e 78 6d 6c ad ... 4270761 more bytes>"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2025-11-14T02:53:39.143Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-exportInventoryToExcel" in 13564.119490000001ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finished \"us-central1-exportInventoryToExcel\" in 13564.119490000001ms"}}
[debug] [2025-11-14T02:53:39.143Z] [worker-us-central1-exportInventoryToExcel-66d19f0e-d0d1-40d9-8891-2bd0bb091b6c]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-66d19f0e-d0d1-40d9-8891-2bd0bb091b6c]: IDLE"}}
[debug] [2025-11-14T02:53:39.143Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2025-11-14T02:53:39.143Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2025-11-14T02:53:39.144Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2025-11-14T02:56:42.808Z] File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers"}}
[debug] [2025-11-14T02:56:43.209Z] File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers"}}
[debug] [2025-11-14T02:56:43.411Z] File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers"}}
[debug] [2025-11-14T02:56:44.413Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[warn] ⚠  functions: Please note that there will be breaking changes when you upgrade. 
[debug] [2025-11-14T02:56:45.558Z] > [functions] package.json contents: {
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "16"
  },
  "main": "index.js",
  "dependencies": {
    "exceljs": "^4.4.0",
    "firebase-admin": "^9.8.0",
    "firebase-functions": "^3.14.1",
    "nodemailer": "^7.0.10"
  },
  "devDependencies": {
    "firebase-functions-test": "^0.2.0"
  },
  "private": true
}
[debug] [2025-11-14T02:56:45.558Z] Building nodejs source
[debug] [2025-11-14T02:56:45.558Z] Failed to find version of module node: reached end of search path /Users/puneet/workspace/vault-app/functions/node_modules
[warn] ⚠  functions: Your requested "node" version "16" doesn't match your global version "24". Using node@24 from host. 
[info] i  functions: You are using a version of firebase-functions SDK (3.24.1) that does not have support for the newest Firebase Extensions features. Please update firebase-functions SDK to >=5.1.0 to use them correctly 
[debug] [2025-11-14T02:56:45.559Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-11-14T02:56:45.560Z] Found firebase-functions binary at '/Users/puneet/workspace/vault-app/functions/node_modules/.bin/firebase-functions'
[info] Serving at port 8761

[debug] [2025-11-14T02:56:46.305Z] Got response from /__/functions.yaml {"endpoints":{"exportInventoryToExcel":{"platform":"gcfv1","labels":{},"callableTrigger":{},"entryPoint":"exportInventoryToExcel"}},"specVersion":"v1alpha1","requiredAPIs":[]}
[debug] [2025-11-14T02:56:48.767Z] File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File /Users/puneet/workspace/vault-app/functions/index.js changed, reloading triggers"}}
[debug] [2025-11-14T02:56:49.769Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[warn] ⚠  functions: Please note that there will be breaking changes when you upgrade. 
[debug] [2025-11-14T02:56:50.477Z] > [functions] package.json contents: {
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "16"
  },
  "main": "index.js",
  "dependencies": {
    "exceljs": "^4.4.0",
    "firebase-admin": "^9.8.0",
    "firebase-functions": "^3.14.1",
    "nodemailer": "^7.0.10"
  },
  "devDependencies": {
    "firebase-functions-test": "^0.2.0"
  },
  "private": true
}
[debug] [2025-11-14T02:56:50.477Z] Building nodejs source
[debug] [2025-11-14T02:56:50.477Z] Failed to find version of module node: reached end of search path /Users/puneet/workspace/vault-app/functions/node_modules
[warn] ⚠  functions: Your requested "node" version "16" doesn't match your global version "24". Using node@24 from host. 
[info] i  functions: You are using a version of firebase-functions SDK (3.24.1) that does not have support for the newest Firebase Extensions features. Please update firebase-functions SDK to >=5.1.0 to use them correctly 
[debug] [2025-11-14T02:56:50.478Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-11-14T02:56:50.478Z] Found firebase-functions binary at '/Users/puneet/workspace/vault-app/functions/node_modules/.bin/firebase-functions'
[info] shutdown requested via /__/quitquitquit

[info] ✔  functions: Loaded functions definitions from source: exportInventoryToExcel. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: exportInventoryToExcel."}}
[debug] [2025-11-14T02:56:50.488Z] [worker-pool] Shutting down IDLE worker (us-central1-exportInventoryToExcel) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-exportInventoryToExcel)"}}
[debug] [2025-11-14T02:56:50.488Z] [worker-us-central1-exportInventoryToExcel-66d19f0e-d0d1-40d9-8891-2bd0bb091b6c]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-66d19f0e-d0d1-40d9-8891-2bd0bb091b6c]: FINISHING"}}
[debug] [2025-11-14T02:56:50.502Z] [worker-us-central1-exportInventoryToExcel-66d19f0e-d0d1-40d9-8891-2bd0bb091b6c]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-66d19f0e-d0d1-40d9-8891-2bd0bb091b6c]: exited"}}
[debug] [2025-11-14T02:56:50.502Z] [worker-us-central1-exportInventoryToExcel-66d19f0e-d0d1-40d9-8891-2bd0bb091b6c]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-exportInventoryToExcel"},"extension":{},"message":"[worker-us-central1-exportInventoryToExcel-66d19f0e-d0d1-40d9-8891-2bd0bb091b6c]: FINISHED"}}
[info] Serving at port 8050

[debug] [2025-11-14T02:56:50.848Z] Got response from /__/functions.yaml {"endpoints":{"exportInventoryToExcel":{"platform":"gcfv1","labels":{},"callableTrigger":{},"entryPoint":"exportInventoryToExcel"}},"specVersion":"v1alpha1","requiredAPIs":[]}
[info] shutdown requested via /__/quitquitquit

[info] ✔  functions: Loaded functions definitions from source: exportInventoryToExcel. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: exportInventoryToExcel."}}
